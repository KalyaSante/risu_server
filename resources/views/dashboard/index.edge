@layout('layouts/dashboard')

@section('title')
  Dashboard
@end

@section('head')
  <!-- Vis.js pour les graphiques -->
  <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
@end

@section('main')
  <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
    <!-- Sidebar avec stats et légende -->
    <div class="lg:col-span-1 space-y-6">
      <!-- Statistiques -->
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h2 class="card-title">📊 Statistiques</h2>
          <div class="stats stats-vertical">

            {{-- Stats pour les serveurs --}}
            <div class="stat">
              <div class="stat-figure text-primary">
                <span class="text-3xl">🖥️</span>
              </div>
              <div class="stat-title">Serveurs</div>
              <div class="stat-value text-primary">{{ servers.length }}</div>
            </div>

            {{-- Stats pour les services --}}
            <div class="stat">
              <div class="stat-figure text-secondary">
                <span class="text-3xl">⚙️</span>
              </div>
              <div class="stat-title">Services</div>
              <div class="stat-value text-secondary">{{ services.length }}</div>
            </div>

            {{-- Stats pour les dépendances --}}
            <div class="stat">
              <div class="stat-figure text-accent">
                <span class="text-3xl">🔗</span>
              </div>
              <div class="stat-title">Dépendances</div>
              <div class="stat-value text-accent">-</div>
            </div>

          </div>
        </div>
      </div>

      <!-- Légende -->
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h3 class="card-title text-lg">🎨 Légende</h3>
          <div class="space-y-3 text-sm">
            <div class="flex items-center gap-3">
              <div class="w-4 h-4 bg-primary rounded"></div>
              <span>Serveurs</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-4 h-4 bg-secondary rounded-full"></div>
              <span>Services</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-8 h-0 border-t-2 border-error"></div>
              <span>Dépendance critique</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-8 h-0 border-t-2 border-warning"></div>
              <span>Dépendance optionnelle</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-8 h-0 border-t-2 border-success"></div>
              <span>Dépendance fallback</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Actions rapides -->
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
          <h3 class="card-title text-lg">⚡ Actions rapides</h3>
          <div class="space-y-2">

            {{-- Bouton nouveau serveur --}}
            <a href="{{ route('servers.create') }}" class="btn btn-primary btn-sm w-full">
              <span>➕</span>
              Nouveau serveur
            </a>

            {{-- Bouton nouveau service --}}
            <a href="{{ route('services.create') }}" class="btn btn-secondary btn-sm w-full">
              <span>⚙️</span>
              Nouveau service
            </a>

          </div>
        </div>
      </div>
    </div>

    <!-- Graphique principal -->
    <div class="lg:col-span-3 space-y-6">
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body p-4">
          <div class="flex justify-between items-center mb-4">
            <h2 class="card-title">🗺️ Cartographie des services</h2>
            <div class="flex gap-2">
              <button id="fit-network" class="btn btn-sm btn-outline">Ajuster la vue</button>
              <button id="physics-toggle" class="btn btn-sm btn-outline">Basculer physique</button>
            </div>
          </div>
          <div id="network-container" class="w-full h-96 border border-base-300 rounded-lg bg-base-50"></div>
        </div>
      </div>

      <!-- Détails du service sélectionné -->
      <div id="service-details" class="card bg-base-100 shadow-xl hidden">
        <div class="card-body">
          <div class="flex justify-between items-center">
            <h3 class="card-title">🔍 Détails du service</h3>
            <button id="close-details" class="btn btn-sm btn-circle btn-ghost">✕</button>
          </div>
          <div id="service-content" class="mt-4">
            <!-- Le contenu sera injecté via JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>
@end

@section('scripts')
  @include('partials/network-script')
@end
