<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Services - Cartographie Kalya</title>
  
  <!-- Tailwind CSS + DaisyUI -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.24/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-base-200">
  <div class="navbar bg-primary text-primary-content">
    <div class="flex-1">
      <a href="{{ route('dashboard.index') }}" class="btn btn-ghost text-xl">üó∫Ô∏è Cartographie Services</a>
    </div>
    <div class="flex-none">
      <ul class="menu menu-horizontal px-1">
        <li><a href="{{ route('dashboard.index') }}">Dashboard</a></li>
        <li><a href="{{ route('servers.index') }}" class="active">Serveurs</a></li>
        <li><a href="{{ route('services.index') }}">Services</a></li>
        <li>
          <details>
            <summary>{{ user?.fullName || user?.email || 'User' }}</summary>
            <ul class="bg-base-100 rounded-t-none p-2">
              <li><a href="{{ route('auth.logout') }}">D√©connexion</a></li>
            </ul>
          </details>
        </li>
      </ul>
    </div>
  </div>

  <main class="container mx-auto p-4">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-3xl font-bold">‚öôÔ∏è Services</h1>
      <a href="{{ route('services.create') }}" class="btn btn-primary">Ajouter un service</a>
    </div>

    @if(flashMessages.has('success'))
      <div class="alert alert-success mb-4">
        <span>{{ flashMessages.get('success') }}</span>
      </div>
    @endif

    @if(flashMessages.has('error'))
      <div class="alert alert-error mb-4">
        <span>{{ flashMessages.get('error') }}</span>
      </div>
    @endif

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      @each(service in services)
        <div class="card bg-base-100 shadow-xl">
          <div class="card-body">
            <h2 class="card-title">
              @if(service.icon)
                <img src="{{ service.icon }}" alt="Icon" class="w-6 h-6">
              @else
                ‚öôÔ∏è
              @endif
              {{ service.nom }}
            </h2>
            <div class="space-y-1 text-sm">
              <p><strong>Serveur:</strong> {{ service.server.nom }}</p>
              @if(service.path)
                <p><strong>Chemin:</strong> <code class="text-xs">{{ service.path }}</code></p>
              @endif
              @if(service.repoUrl)
                <p><strong>Repository:</strong> <a href="{{ service.repoUrl }}" target="_blank" class="link">Voir le code</a></p>
              @endif
              @if(service.lastMaintenanceAt)
                <p><strong>Derni√®re maintenance:</strong> {{ service.lastMaintenanceAt.toFormat('dd/MM/yyyy') }}</p>
              @endif
            </div>
            <div class="card-actions justify-end">
              <a href="{{ route('services.show', { id: service.id }) }}" class="btn btn-primary btn-sm">Voir</a>
              <a href="{{ route('services.edit', { id: service.id }) }}" class="btn btn-secondary btn-sm">Modifier</a>
            </div>
          </div>
        </div>
      @else
        <div class="col-span-full">
          <div class="card bg-base-100 shadow-xl">
            <div class="card-body text-center">
              <h2 class="card-title justify-center">Aucun service trouv√©</h2>
              <p>Commencez par ajouter votre premier service √† la cartographie.</p>
              <div class="card-actions justify-center">
                <a href="{{ route('services.create') }}" class="btn btn-primary">Ajouter un service</a>
              </div>
            </div>
          </div>
        </div>
      @end
    </div>
  </main>
</body>
</html>
